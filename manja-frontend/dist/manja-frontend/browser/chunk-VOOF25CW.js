import{Aa as A,Ba as M,Bb as J,C as m,Ca as T,Cb as E,Da as g,Ea as y,H as u,J as _,Ja as U,M as R,Ma as S,N as j,Na as P,P as $,Q as F,U as D,Uc as o,V as B,Wc as H,Xa as b,Xc as I,Yc as K,Z as w,Za as O,Zc as W,_a as z,a as l,b as p,bd as Q,fa as v,gb as Y,j as c,jb as V,o as k,q as f,sb as G,ua as C}from"./chunk-CXM4KAOA.js";var L=["Janvier","F\xE9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xFBt","Septembre","Octobre","Novembre","D\xE9cembre"],te=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],X=te.map(s=>({legend:s,code:s.charAt(0)}));function Z(s,i){return s.map(n=>ie(n,i))}function ie(s,i){let n=o(),e=i?.month??n.month(),t=s.month()===e,a=i?.openDays?i.openDays.includes(s.day()-1):!0,r=s.isBefore(n,"date"),d=i?.highlightedDates?i.highlightedDates.some(x=>x.isSame(s,"date")):!1;return{value:s,isPriorToCurrent:r,belongsToMonth:t,isCurrentDate:se(s),isOpenDay:a,selectable:a&&!r,selected:ae(s,{selectedDates:i?.selectedDates,selected:i?.selected}),isHighlighted:d}}function se(s){return s.isSame(o(),"date")}function ae(s,i){return!!(i.selected||i.selectedDates?.some(n=>n.value.isSame(s,"date")))}var ne=s=>({"size-8 flex items-center justify-center rounded-full cursor-pointer focus:outline-none":!0,"text-secondary":!0,"text-red-300":s});function re(s,i){if(s&1&&(g(0,"div",7),b(1),y()),s&2){let n=i.$implicit,e=i.$index,t=P();C("ngClass",Y(3,ne,!t.openDays.includes(e)))("title",t.openDays.includes(e)?n.legend:n.legend+" : Jour non ouvrable"),v(),O(" ",n.code," ")}}var oe=(s,i,n,e,t)=>({"size-8 flex items-center justify-center rounded-full cursor-pointer focus:outline-none":!0,"text-primary":s,"text-secondary":i,"text-light bg-dark hover:bg-dark hover:opacity-75":n,"hover:bg-gray-200":e,"bg-tumbleweed":t});function le(s,i){if(s&1){let n=U();g(0,"div",8),S("click",function(){let a=$(n).$implicit,r=P();return F(r.selectDate(a))}),b(1),y()}if(s&2){let n=i.$implicit;C("title",n.isOpenDay?"":"Jour non ouvrable")("ngClass",V(3,oe,n.belongsToMonth&&n.isOpenDay&&!n.isCurrentDate,!n.belongsToMonth&&!n.isOpenDay&&!!n.isCurrentDate,n.isCurrentDate,n.selectable&&!n.selected,n.selectable&&n.selected)),v(),O(" ",n.value.date()," ")}}var ke=(()=>{let i=class i{constructor(){this.weeksNumber=6,this.dateRange=[],this.openDays=[0,1,2,3,4,5,6],this.weekDays=X,this.referenceDate=o(),this.selectedDates=[],this.updateSelectedDates=new _,this.updateReferenceDate=new _,this.currentMonth=L[this.referenceDate.month()],this.currentYear=this.referenceDate.year(),this.dailyNonAvailableHours=[],this.generateDates(this.referenceDate)}generateDates(e,t=[]){let a=e.second(1).date(1).second(0),r=e.endOf("month"),d=[];for(let h=1;h<a.day();h++)d.push(a.day(h));for(let h=a.date();h<=r.date();h++)d.push(a.date(h));let x=this.weeksNumber*7-d.length;for(let h=r.date()+1;h<=r.date()+x;h++)d.push(r.date(h));this.setDateRange(Z(d,{month:e.month(),openDays:this.openDays,selectedDates:t}))}setDateRange(e){this.dateRange=e}nextMonth(){this.changeMonth(1)}previousMonth(){this.changeMonth(-1)}changeMonth(e){let t=this.referenceDate.month(this.referenceDate.month()+e);this.currentMonth=L[t.month()],this.currentYear=t.year(),this.generateDates(t,this.selectedDates),this.updateReferenceDate.emit(t)}selectDate(e){e.selectable&&(e.selected=!0,this.updateSelectedDates.emit([e.value]),this.generateDates(this.referenceDate,[e]))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=R({type:i,selectors:[["datepicker"]],inputs:{referenceDate:"referenceDate",selectedDates:"selectedDates",dailyNonAvailableHours:"dailyNonAvailableHours"},outputs:{updateSelectedDates:"updateSelectedDates",updateReferenceDate:"updateReferenceDate"},decls:15,vars:2,consts:[[1,"w-92","select-none"],[1,"max-h-106","w-full","h-96","text-sm"],[1,"mb-5","flex","justify-between"],[1,"text-primary"],[1,"flex","gap-x-1","text-secondary"],[1,"size-6","flex","items-center","justify-center","rounded-full","text-secondary","hover:bg-gray-200","cursor-pointer","focus:outline-none",3,"click"],[1,"grid","grid-cols-7","gap-y-3"],[3,"ngClass","title"],[3,"title","ngClass","click"],[3,"title","ngClass"]],template:function(t,a){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),b(4),y(),g(5,"div",4)(6,"div",5),S("click",function(){return a.previousMonth()}),b(7," < "),y(),g(8,"div",5),S("click",function(){return a.nextMonth()}),b(9," > "),y()()(),g(10,"div",6),M(11,re,2,5,"div",7,A),M(13,le,2,9,"div",9,A),y()()()),t&2&&(v(4),z("",a.currentMonth," ",a.currentYear,""),v(7),T(a.weekDays),v(2),T(a.dateRange))},dependencies:[G]});let s=i;return s})();var Te=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=j({type:i}),i.\u0275inj=B({imports:[J]});let s=i;return s})();function Oe(s){return i=>{let n=i.root.get(s);return n&&i.value!==n.value?{notEqual:!0}:null}}function He(s){return i=>{let n=i.value;return n&&n.size/1048576>s?{imageSize:!0}:null}}function Ie(s,i){return n=>{let e=n.root.get(s)?n.root.get(s).value:null,t=n.root.get(i)?n.root.get(i).value:null;if(console.log(e,t),e&&t){let a=new Date("2000-01-01T"+e);if(new Date("2000-01-01T"+t)<=a)return{time:!0}}return null}}var pe=[{name:"Hair Styling",slug:"hair-styling",description:"Various hair styling services",imgPath:"https://assets-global.website-files.com/60993dcfc8e83c6e36ae8b81/60a5aef88e07303a3df5cd5b_makeup-salon-webflow-template.jpg",subServices:[{name:"Hair Coloring",slug:"",description:"Get a fresh hair color!",duration:120,price:80,ptgCommission:.15,promotions:[{}],history:[]},{name:"Men Haircut",slug:"men-haircut",description:"Classic men's haircut",duration:30,price:25,ptgCommission:.12,promotions:[{}],history:[]},{name:"Blowout",slug:"blowout",description:"Professional blow-dry styling",duration:45,price:40,ptgCommission:.1,promotions:[{}],history:[]},{name:"Updo",slug:"updo",description:"Elegant updo hairstyles",duration:60,price:60,ptgCommission:.18,promotions:[{}],history:[]}]},{name:"Makeup Artistry",slug:"makeup-artistry",description:"Expert makeup services",imgPath:"https://assets-global.website-files.com/60993dcfc8e83c6e36ae8b81/60a5aef88e07303a3df5cd5b_makeup-salon-webflow-template.jpg",subServices:[{name:"Bridal Makeup",slug:"bridal-makeup",description:"Gorgeous bridal makeup",duration:90,price:150,ptgCommission:.2,promotions:[{}],history:[]},{name:"Evening Glam",slug:"evening-glam",description:"Dramatic evening makeup",duration:60,price:80,ptgCommission:.18,promotions:[{}],history:[]},{name:"Natural Look",slug:"natural-look",description:"Subtle and natural makeup",duration:45,price:60,ptgCommission:.15,promotions:[{}],history:[]},{name:"Airbrush Makeup",slug:"airbrush-makeup-look",description:"Flawless airbrush makeup",duration:75,price:120,ptgCommission:.17,promotions:[{}],history:[]}]},{name:"Nail Services",slug:"nail-services",description:"Beautiful nail treatments",imgPath:"https://assets-global.website-files.com/60993dcfc8e83c6e36ae8b81/60a5aef88e07303a3df5cd5b_makeup-salon-webflow-template.jpg",subServices:[{name:"Manicure",slug:"manicure",description:"Classic nail grooming",duration:45,price:35,ptgCommission:.2,promotions:[{}],history:[]},{name:"Pedicure",slug:"pedicure",description:"Relaxing foot care",duration:60,price:50,ptgCommission:.18,promotions:[{}],history:[]}]},{name:"Facial Treatments",slug:"facial-treatments",description:"Revitalize your skin",imgPath:"https://assets-global.website-files.com/60993dcfc8e83c6e36ae8b81/60a5aef88e07303a3df5cd5b_makeup-salon-webflow-template.jpg",subServices:[{name:"Deep Cleansing Facial",slug:"deep-cleansing-facial",description:"Thorough skin cleansing",duration:75,price:90,ptgCommission:.15,promotions:[{}],history:[]},{name:"Anti-Aging Facial",slug:"anti-aging-facial",description:"Combat signs of aging",duration:90,price:120,ptgCommission:.17,promotions:[{}],history:[]}]}],q=pe.map(s=>s.subServices).flat();var me=[{_id:"1",firstname:"Alice",lastname:"Smith",email:"alice.smith@company.com",username:"asmith",password:"P@ssw0rd1",subServices:[],imgPath:"img-path"},{_id:"2",firstname:"Bob",lastname:"Johnson",email:"bob.johnson@company.com",username:"bjohnson",password:"Secret123",subServices:[],imgPath:"img-path"},{_id:"3",firstname:"Carol",lastname:"Brown",email:"carol.brown@company.com",username:"cbrown",password:"SecurePass1",subServices:[],imgPath:"img-path"},{_id:"4",firstname:"David",lastname:"Lee",email:"david.lee@company.com",username:"dlee",password:"MyP@ssw0rd!",subServices:[],imgPath:"img-path"},{_id:"5",firstname:"Eva",lastname:"Garcia",email:"eva.garcia@company.com",username:"egarcia",password:"Eva1234",subServices:[],imgPath:"img-path"},{_id:"6",firstname:"Frank",lastname:"Rodriguez",email:"frank.rodriguez@company.com",username:"frodriguez",password:"FrankPass",subServices:[],imgPath:"img-path"},{_id:"7",firstname:"Grace",lastname:"Miller",email:"grace.miller@company.com",username:"gmiller",password:"GracePass1",subServices:[],imgPath:"img-path"},{_id:"8",firstname:"Henry",lastname:"Clark",email:"henry.clark@company.com",username:"hclark",password:"Henry1234",subServices:[],imgPath:"img-path"},{_id:"9",firstname:"Isabel",lastname:"Wright",email:"isabel.wright@company.com",username:"iwright",password:"IsabelPass",subServices:[],imgPath:"img-path"},{_id:"10",firstname:"Jack",lastname:"Baker",email:"jack.baker@company.com",username:"jbaker",password:"Baker5678",subServices:[],imgPath:"img-path"},{_id:"11",firstname:"Karen",lastname:"Turner",email:"karen.turner@company.com",username:"kturner",password:"KarenPass",subServices:[],imgPath:"img-path"},{_id:"12",firstname:"Liam",lastname:"Harris",email:"liam.harris@company.com",username:"lharris",password:"Liam9876",subServices:[],imgPath:"img-path"}];function ce(s,i=3){let n=0;return s.map(e=>(e.subServices.push(...q.filter((t,a)=>a>=n&&a<n+i)),n++,e))}var ue=ce(me);function ee(s){let i=ue;if(!s)return i;if(s.filters){if(s.filters.name){let n=s.filters.name;i=i.filter(e=>e.firstname.includes(n))}if(s.filters.serviceSlug){let n=s.filters.serviceSlug;i=i.filter(e=>e.subServices.some(t=>t.slug===n))}}return s.orderBy&&(s.orderBy.field,s.orderBy.order==="ASC"||s.orderBy.order==="DESC"&&i.reverse()),i}var Ue=(()=>{let i=class i{constructor(e){this.http=e,this.employeeList=new c(null),this.employeeSubServicesNames=new c(null)}getEmployees(e){return k(ee(e)).pipe(u({next:t=>{this.setEmployees(t)},error:()=>{throw Error("not implemented yet")}}),m(1))}setEmployees(e){this.employeeList.next(e)}getEmployeeSchedule(e,t){return!e||!t?k({success:!0,payload:null}):this.http.get(`/v1/employees/${e}/schedules?date=${t.format("YYYY-MM-DD")}`).pipe(f(a=>p(l({},a),{payload:Q(a.payload,t)})),u({next:a=>{},error:a=>{throw console.log(a),Error("not implemented yet")}}),m(1))}getListEmployees(){return this.http.get("/v1/employees").pipe(m(1))}getEmployeesById(e){return this.http.get(`/v1/employees/${e}`).pipe(m(1))}addNewEmployee(e){return this.http.post("/v1/employees",e).pipe(m(1))}updateEmployee(e,t){return this.http.put(`/v1/employees/${e}`,t).pipe(m(1))}updateEmployeeItself(e){return this.http.put("/v1/employees",e).pipe(m(1))}updateEmployeeWorkSchedules(e){return this.http.put("/v1/employees/work-schedules",e).pipe(m(1))}updateEmployeeActivation(e,t){return this.http.put(`/v1/employees/${e}/activation`,{active:t}).pipe(m(1))}getEmployeeSubServiceNames(e){if(!e||e.role!=="EMPLOYEE")throw new Error("not implemented yet : insuffisent permission");return this.http.get("/v1/employee/subservices").pipe(u({next:t=>{this.employeeSubServicesNames.next(t.payload)},error:t=>{throw console.log(t),Error("not implemented yet")}}),m(1))}};i.\u0275fac=function(t){return new(t||i)(w(E))},i.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var Ke=(()=>{let i=class i{constructor(e){this.http=e,this.DEFAULT_SUBSERVICE_DURATION=60,this.DEFAULT_OPENING_HOUR=8,this.DEFAULT_CLOSING_HOUR=17,this.insertedAppointment=new c(null),this.selectedSubService=new c(null),this.enablePostAppointment=new c(!1),this.selectedEmployee=new c(null),this.businessHours=new c({start:o().hour(this.DEFAULT_OPENING_HOUR).minute(0).second(0).millisecond(0),end:o().hour(this.DEFAULT_CLOSING_HOUR).minute(0).second(0).millisecond(0)}),this.nonAvailableHours=new c([]),this.referenceDate=new c(o().date(1).hour(0).minute(0).second(0).millisecond(0)),this.selectedDate=new c(K(o().hour(this.DEFAULT_OPENING_HOUR).minute(0).second(0).millisecond(0),o().hour(this.DEFAULT_OPENING_HOUR).minute(0).second(0).millisecond(0),o().hour(this.DEFAULT_CLOSING_HOUR).minute(0).second(0).millisecond(0),this.DEFAULT_SUBSERVICE_DURATION)),this.appointmentsHistory=new c(null),this.appointment=new c(null),this.appointmentList=new c(null),this.dailyTaskDate=new c(o()),this.dailyTaskDetails=new c(null),this.selectedEmployee$=this.selectedEmployee.asObservable(),this.selectedSubService$=this.selectedSubService.asObservable(),this.referenceDate$=this.referenceDate.asObservable(),this.selectedDate$=this.selectedDate.asObservable(),this.businessHours$=this.businessHours.asObservable(),this.nonAvailableHours$=this.nonAvailableHours.asObservable(),this.insertedAppointment$=this.insertedAppointment.asObservable(),this.enablePostAppointment$=this.enablePostAppointment.asObservable(),this.appointmentsHistory$=this.appointmentsHistory.asObservable(),this.appointment$=this.appointment.asObservable(),this.appointmentList$=this.appointmentList.asObservable(),this.dailyTaskDate$=this.dailyTaskDate.asObservable(),this.dailyTaskDetails$=this.dailyTaskDetails.asObservable()}setSelectedSubService(e){this.selectedSubService.next(e)}setNonAvailableHours(e){this.nonAvailableHours.next(e)}getSelectedDateValue(){return this.selectedDate.value}setBusinessHours(e){if(!e){this.businessHours.next(null);return}let t=this.getSelectedDateValue().start;e.start=H(o(e.start),t),e.end=H(o(e.end),t),this.businessHours.next(e)}updateReferenceDate(e){this.referenceDate.next(e)}updateSelectedDate(e){if(this.businessHours.value){let t={start:I(e,this.businessHours.value.start),end:I(e,this.businessHours.value.end)};this.businessHours.next({start:e.hour(t.start.hour()).minute(t.start.minute()).second(0).millisecond(0),end:e.hour(t.end.hour()).minute(t.end.minute()).second(0).millisecond(0)}),this.selectedDate.next(W({start:e,end:e.add(this.selectedSubService.value?this.selectedSubService.value.duration:this.DEFAULT_SUBSERVICE_DURATION,"minute")},t))}else this.selectedDate.next({start:e,end:e,dailyPercentage:0,duration:0,percentageStart:0,percentageEnd:0})}getReferenceDate(){return this.referenceDate$}setSelectedEmployee(e){this.selectedEmployee.next(e)}checkEnablePostAppointment(){this.enablePostAppointment.next(!!(!this.insertedAppointment.value&&this.selectedSubService.value&&this.selectedEmployee.value&&this.selectedDate.value&&this.businessHours.value!==null))}postAppointment(){if(!this.selectedSubService.value||!this.selectedEmployee.value?._id)throw Error("not implemented yet : Veuillez s\xE9lectionnez une offre et un employ\xE9");let e={appointmentDate:this.selectedDate.value.start.toDate(),employeeId:this.selectedEmployee.value._id,subServiceSlug:this.selectedSubService.value.slug},t=this.http.post("/v1/appointments",e).pipe(u({next:a=>{console.log(a),this.insertedAppointment.next(a.payload),this.enablePostAppointment.next(!1)},error:a=>{throw console.log(a),Error("not implemented yet")}}),m(1));return t.subscribe(a=>{},a=>console.log("error",a)),t}getAppointmentsHistory(){return this.http.get("/v1/appointments/history").pipe(f(e=>p(l({},e),{payload:e.payload.map(t=>{let a=o(t.appointmentDate),r=t.duration/60;return p(l({},t),{appointmentDate:a,appointmentDateEnd:a.add(r,"minute"),duration:r})})})),u({next:e=>{this.appointmentsHistory.next(e.payload)},error:e=>{throw console.log(e),Error("not implemented yet : api error")}}),m(1))}getAppointment(e){if(!e)throw new Error("!appointmentId");return this.http.get(`/v1/appointments/${e}`).pipe(f(t=>{let a=t.payload.duration/60,r=o(t.payload.appointmentDate);return p(l({},t),{payload:p(l({},t.payload),{duration:a,appointmentDate:r})})}),u({next:t=>{this.appointment.next(t.payload)},error:t=>{throw console.log(t),Error("not implemented yet : api error")}}),m(1))}payAppointment(){let e=this.appointment.value;if(e){if(e.status>0)throw new Error("Ce rendez-vous a d\xE9ja \xE9t\xE9 pay\xE9")}else throw new Error("Impossibilit\xE9 d'effectuer un paiement. !Paiement");return this.http.put(`/v1/appointments/${e._id}/pay`,{}).pipe(f(t=>{let a=t.payload.duration/60,r=o(a);return p(l({},t),{payload:p(l({},t.payload),{duration:a,appointmentDate:r})})}),u({next:t=>{this.appointment.next(t.payload)},error:t=>{throw console.log(t),Error("not implemented yet : api error")}}),m(1))}validateAppointmentDone(e){if(e){if(e.status===3)throw new Error("Ce rendez-vous a d\xE9ja \xE9t\xE9 effectu\xE9. Vous ne pouvez plus valider ce rendez-vous");if(!this.appointmentList.value||!this.appointmentList.value.some(t=>t._id===e._id))throw new Error("Can't update an appointment that is not in the appointments' list")}else throw new Error("Impossibilit\xE9 de mettre \xE0 jour le status \xE0 'fait'. !AppointmentDetails");return this.http.put(`/v1/appointments/${e._id}/done`,{}).pipe(f(t=>{let a=t.payload.duration/60,r=o(a);return p(l({},t),{payload:p(l({},t.payload),{duration:a,appointmentDate:r})})}),u({next:t=>{this.appointmentList.value&&this.appointmentList.next(this.appointmentList.value.map(a=>p(l({},a),{status:a._id===t.payload._id?t.payload.status:a.status})))},error:t=>{throw console.log(t),Error("not implemented yet : api error")}}),m(1))}cancelAppointment(e){if(e){if(e.status===3)throw new Error("Ce rendez-vous a d\xE9ja \xE9t\xE9 effectu\xE9. Vous ne pouvez plus annuler ce rendez-vous");if(!this.appointmentList.value||!this.appointmentList.value.some(t=>t._id===e._id))throw new Error("Can't update an appointment that is not in the appointments' list")}else throw new Error("Impossibilit\xE9 de mettre \xE0 jour le status \xE0 'annul\xE9'. !AppointmentDetails");return this.http.put(`/v1/appointments/${e._id}/cancel`,{}).pipe(f(t=>{let a=t.payload.duration/60,r=o(a);return p(l({},t),{payload:p(l({},t.payload),{duration:a,appointmentDate:r})})}),u({next:t=>{this.appointmentList.value&&this.appointmentList.next(this.appointmentList.value.map(a=>p(l({},a),{status:a._id===t.payload._id?t.payload.status:a.status})))},error:t=>{throw console.log(t),Error("not implemented yet : api error")}}),m(1))}getAppointments(){if(!this.selectedDate.value)throw new Error("no selected date provided");return this.http.get(`/v1/appointments?referenceDate=${this.selectedDate.value.start.format("YYYY-MM-DD")}`).pipe(f(e=>p(l({},e),{payload:e.payload.map(t=>{let a=o(t.appointmentDate),r=t.duration/60,d=t.client.firstname+" "+t.client.lastname;return p(l({},t),{appointmentDate:a,appointmentDateEnd:a.add(r,"minute"),duration:r,client:p(l({},t.client),{name:d})})})})),u({next:e=>{this.appointmentList.next(e.payload)},error:e=>{throw console.log(e),Error("not implemented yet : api error")}}),m(1))}getAppointmentDailyTasks(){if(!this.dailyTaskDate.value)throw new Error("no selected date provided");return this.http.get(`/v1/appointments/daily-tasks/${this.dailyTaskDate.value.format("YYYY-MM-DD")}`).pipe(f(e=>p(l({},e),{payload:p(l({},e.payload),{appointments:e.payload.appointments.map(t=>{let a=o(t.appointmentDate),r=t.duration/60,d=t.client.firstname+" "+t.client.lastname;return p(l({},t),{appointmentDate:a,appointmentDateEnd:a.add(r,"minute"),duration:r,client:d})})})})),u({next:e=>{this.dailyTaskDetails.next(e.payload)},error:e=>{throw console.log(e),Error("not implemented yet : api error")}}),m(1))}};i.\u0275fac=function(t){return new(t||i)(w(E))},i.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();export{Oe as a,He as b,Ie as c,Ue as d,Ke as e,ie as f,ke as g,Te as h};
